#language: ru

@tree
@ExportScenarios
@IgnoreOnCIMainBuild

Функционал: подключение клиентов тестирования

//Переменные:
//	*Клиенты тестирования
//			| 'Имя'        | 'Синоним' | 'Тип клиента' | 'Порт'  | 'Строка соединения'              | 'Логин'       | 'Пароль'   | 'Дополнительные параметры строки запуска' |
//			| 'Клиент БГУ' | ''        | 'Тонкий'      | '48001' | 'Srvr=\"rigel\";Ref=\"YRBGU2\";' | 'БрызгаловаЮ' | 'ceqiD977' | '/БрызгаловаЮ /P ceqiD977'                |


Контекст:
	Дано Я запускаю сценарий открытия TestClient или подключаю уже существующий


Сценарий: подключение клиента тестирования с параметрами
		И я подключаю клиент тестирования с параметрами:
			| 'Имя'        | 'Синоним' | 'Тип клиента' | 'Порт'  | 'Строка соединения'              | 'Логин'       | 'Пароль'   | 'Дополнительные параметры строки запуска' |
			| 'Клиент БГУ' | ''        | 'Тонкий'      | '48001' | 'Srvr=\"rigel\";Ref=\"YRBGU2\";' | 'БрызгаловаЮ' | 'ceqiD977' | '/БрызгаловаЮ /P ceqiD977'                |
		И я вывожу сообщение в менеджер тестирования "Клиент подключен"


Сценарий: подключение нескольких клиентов тестирования из таблицы
		И в таблице клиентов тестирования я активизирую строку 'Клиент БГУ'
		И пауза 25
		И в текущей строке клиентов тестирования я заполняю пользователя
		И я вывожу сообщение в менеджер тестирования "Клиент1 подключен"
		
		Дано Я закрыл все окна клиентского приложения
		И я закрываю сеанс TESTCLIENT
		И Я подключаю клиент тестирования "" из таблицы клиентов тестирования
		И я вывожу сообщение в менеджер тестирования "Клиент2 подключен"

		Дано Я закрыл все окна клиентского приложения
		И я закрываю сеанс TESTCLIENT
		И Я подключаю клиент тестирования "" из таблицы клиентов тестирования
		И я вывожу сообщение в менеджер тестирования "Клиент3 подключен"
		

Сценарий: подключение клиента тестирования из глобальной переменной
	И я подключаю профиль TestClient "$$КлиентТестирования2$$"
	И я вывожу сообщение в менеджер тестирования "Клиент подключен"
	
Сценарий: подключение нескольких клиентов тестирования из таблицы и создание решения об инвентаризации

    // Объявляем переменную для хранения всех клиентов
    Переменная ВсеКлиенты;
    Переменная НомерСтроки; // Вспомогательная переменная

    // Получаем количество строк в таблице
    И получить количество строк таблицы "Клиенты тестирования" в переменную НомерСтроки

    // Инициализируем пустой массив для хранения данных клиентов
    ВсеКлиенты = Новый Массив;

    // Цикл по каждой строке таблицы
    Для НомерСтроки = 1 По НомерСтроки Цикл

        // Создаем пустую структуру для хранения данных текущей строки
        Переменная ТекущийКлиент = Новый Структура;
        
        // Заполняем структуру данными из текущей строки таблицы
        И в таблице "Клиенты тестирования" я получаю данные строки с номером НомерСтроки в структуру ТекущийКлиент
        
        // Добавляем текущий клиент в массив всех клиентов
        ВсеКлиенты.Добавить(ТекущийКлиент);

    КонецЦикла;
        
    // Итерируем по каждому клиенту из массива
    Для каждого Клиент Из ВсеКлиенты Цикл
    
        // Выбираем текущего клиента из таблицы по его номеру
        И в таблице клиентов тестирования я активизирую строку с номером Клиент.НомерСтроки
        И пауза 25
        И в текущей строке клиентов тестирования я заполняю пользователя
		
		// Выводим сообщение о подключении текущего клиента
        И я вывожу сообщение в менеджер тестирования "Подключен клиент №" + Клиент.НомерСтроки
        
        // Вызываем внешний сценарий "И создание решения о проведении инфентаризации"
        И выполнить сценарий "И создание решения о проведении инфентаризации"
	
        Дано Я закрыл все окна клиентского приложения
		И я закрываю сеанс TESTCLIENT
        
    КонецЦикла;